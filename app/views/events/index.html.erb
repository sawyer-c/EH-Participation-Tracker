<p id="notice"><%= notice %></p>

<h1>Events</h1>

<br>

<table id="dttb2" class="table">
  <thead>
    <tr>
      <th>Name</th>
      <th>Date</th>
      <th>Description</th>
      <th>EventType</th>
      <th>Location</th>
      <th>Actions</th>
      <th>Student Actions</th>
    </tr>
  </thead>
  <tbody>
    <% @events.each do |c| %>
       <tr>
        <td><%= c.name %></td>
        <td><%= c.date%></td>
        <td><%= c.description%></td>
        <td><%= c.event_type %></td>
        <td><%= c.location %></td>
        <td>
          <b> <%= link_to '<i class="fa fa-pencil fa-lg" aria-hidden="true" data-toggle="tooltip" title="Edit"></i>'.html_safe, edit_event_path(c)%></b> |
          <b> <%= link_to '<i class="fa fa-trash fa-lg" aria-hidden="true" data-toggle="tooltip" title="Delete"></i>'.html_safe, c,  method: :delete, data: { confirm: 'Are you sure?' } %></b> |
          <b> <%= link_to '<i class="fa fa-search fa-lg" aria-hidden="true" data-toggle="tooltip" title="View"></i>'.html_safe, c%></b>
        </td>
        <td>
          <button id="<%=c.id %>Attend" onclick="clickedAttend(this);" type="btn btn-lg btn-primary">Attend</button>
          <button id="<%=c.id %>AttendR" style="display: none" onclick="clickedUnAttend(this);" type="btn btn-lg btn-primary">UnAttend</button>
        </td>
       </tr>
       <% end %>
    <% if @events.blank? %>
        <tr>
            <td>There are not any events currently in the system.</td>
        </tr>
    <% end %>
        
  </tbody>
</table>

<%= link_to '<span data-toggle="tooltip" title="Add New Event to Collection"><i class="fa fa-plus fa-lg" aria-hidden="true"></i>&nbsp;Add Event</span>'.html_safe, new_event_path%>

<div style="margin-top:10px;">
</div>

<%= form_tag import_events_path, multipart: true do %>
  <%= file_field_tag :file %>
  <%= submit_tag "Import CSV" %>
<% end %>

<div style="margin-top:10px;">
</div>

<%= link_to "Download CSV", events_path(format: "csv") %>

<script type="text/javascript">
  function clickedAttend(item) {
    console.log(name);
    $('#' + item.id).toggle();
    $('#' + item.id + 'R').toggle();
   }

   function clickedUnAttend(item) {
    console.log(name);
    $('#' + item.id).toggle();
    console.log(item.id.substring(0, item.id.length-2));
    $('#' + item.id.substring(0, item.id.length-1)).toggle();
   }
</script>